<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gravel God Coaching Intake - Athlete OS</title>
    
    <!-- Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Sometype+Mono:wght@400;500;600;700&display=swap" rel="stylesheet" />
    
    <style>
        :root {
            --gg-bg: #ffffff;
            --gg-fg: #111111;
            --gg-border: #000000;
            --gg-muted: #777777;
            --gg-soft: #f5f5f5;
            --gg-success: #4caf50;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 32px auto 64px auto;
            padding: 0 20px;
            max-width: 800px;
            background: var(--gg-bg);
            color: var(--gg-fg);
            font-family: "Sometype Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-size: 15px;
            line-height: 1.7;
            letter-spacing: 0.01em;
        }

        h1 {
            font-size: 26px;
            padding-bottom: 6px;
            border-bottom: 3px solid var(--gg-border);
            text-transform: uppercase;
            letter-spacing: 0.16em;
            margin-top: 0;
            margin-bottom: 1.5rem;
        }

        .intro {
            color: var(--gg-muted);
            margin-bottom: 32px;
            font-size: 14px;
        }

        .survey-form {
            margin-top: 2rem;
        }

        .question-group {
            margin-bottom: 2.5rem;
        }

        .question-label {
            display: block;
            font-weight: 600;
            font-size: 15px;
            margin-bottom: 0.8rem;
            color: var(--gg-fg);
        }

        .question-help {
            font-size: 12px;
            color: var(--gg-muted);
            margin-top: 0.4rem;
            margin-bottom: 0.8rem;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="number"],
        input[type="date"],
        input[type="time"],
        select,
        textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--gg-border);
            background: var(--gg-bg);
            color: var(--gg-fg);
            font-family: inherit;
            font-size: 14px;
            line-height: 1.5;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .radio-group,
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 0.8rem;
        }

        .radio-option,
        .checkbox-option {
            display: flex;
            align-items: flex-start;
            padding: 8px;
            border: 1px solid var(--gg-border);
            background: var(--gg-soft);
            cursor: pointer;
            transition: background 0.2s;
        }

        .radio-option:hover,
        .checkbox-option:hover {
            background: #e8e8e8;
        }

        .radio-option input[type="radio"],
        .checkbox-option input[type="checkbox"] {
            margin-right: 10px;
            margin-top: 2px;
            cursor: pointer;
        }

        .radio-option label,
        .checkbox-option label {
            cursor: pointer;
            flex: 1;
            margin: 0;
        }

        .rating-scale {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 0.8rem;
            gap: 8px;
        }

        .rating-scale input[type="radio"] {
            display: none;
        }

        .rating-scale label {
            flex: 1;
            padding: 10px;
            border: 1px solid var(--gg-border);
            background: var(--gg-soft);
            text-align: center;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 13px;
            margin-bottom: 0;
        }

        .rating-scale label:hover {
            background: #e8e8e8;
        }

        .rating-scale input[type="radio"]:checked + label {
            background: var(--gg-fg);
            color: var(--gg-bg);
            font-weight: 600;
        }

        .conditional {
            display: none;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px dashed var(--gg-border);
        }

        .conditional.visible {
            display: block;
        }

        .honeypot {
            position: absolute;
            left: -9999px;
            opacity: 0;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .form-row-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .schedule-grid {
            overflow-x: auto;
            margin-top: 0.8rem;
        }

        .schedule-grid table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        .schedule-grid th,
        .schedule-grid td {
            padding: 12px 8px;
            text-align: left;
            border: 1px solid var(--gg-border);
            font-size: 12px;
        }

        .schedule-grid th {
            background: var(--gg-soft);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--gg-fg);
        }

        .schedule-grid td {
            background: var(--gg-bg);
        }

        .schedule-grid select {
            width: 100%;
            padding: 8px;
            font-size: 11px;
        }

        .schedule-grid .day-cell {
            font-weight: 600;
            background: var(--gg-soft);
        }

        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 8px;
            margin-top: 0.8rem;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            background: var(--gg-soft);
            border: 1px solid var(--gg-border);
            cursor: pointer;
            transition: all 0.2s;
        }

        .checkbox-item:hover {
            background: #e8e8e8;
        }

        .checkbox-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            margin: 0;
        }

        .checkbox-item span {
            font-size: 12px;
        }

        .checkbox-item.selected {
            border-color: var(--gg-fg);
            background: rgba(17, 17, 17, 0.05);
        }

        .info-box {
            background: var(--gg-soft);
            border: 1px solid var(--gg-border);
            padding: 16px;
            margin-bottom: 24px;
        }

        .info-box p {
            font-size: 13px;
            color: var(--gg-muted);
            margin: 0;
        }

        .info-box strong {
            color: var(--gg-fg);
        }

        .label-hint {
            font-weight: 400;
            text-transform: none;
            letter-spacing: normal;
            color: var(--gg-muted);
            opacity: 0.7;
            display: block;
            margin-top: 4px;
            font-size: 12px;
        }

        .submit-button {
            width: 100%;
            padding: 14px 24px;
            margin-top: 2rem;
            background: var(--gg-fg);
            color: var(--gg-bg);
            border: 2px solid var(--gg-border);
            font-family: inherit;
            font-size: 15px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
        }

        .submit-button:hover {
            background: var(--gg-muted);
        }

        .add-race-btn:hover {
            background: #f0f0f0;
        }

        .race-entry {
            transition: box-shadow 0.2s;
        }

        .race-entry:hover {
            box-shadow: 2px 2px 0 #000;
        }

        .submit-button:disabled {
            background: var(--gg-soft);
            color: var(--gg-muted);
            cursor: not-allowed;
        }

        .loading {
            display: none;
            padding: 20px;
            border: 2px solid var(--gg-border);
            background: var(--gg-soft);
            margin-top: 2rem;
            text-align: center;
        }

        .loading.show {
            display: block;
        }

        .error-message {
            display: none;
            padding: 12px;
            border: 1px solid #d32f2f;
            background: #ffebee;
            color: #c62828;
            margin-top: 1rem;
            font-size: 13px;
        }

        .error-message.show {
            display: block;
        }

        .success-message {
            display: none;
            padding: 20px;
            border: 2px solid var(--gg-success);
            background: #f1f8f4;
            margin-top: 2rem;
            text-align: center;
        }

        .success-message.show {
            display: block;
        }

        .required {
            color: #d32f2f;
        }

        @media (max-width: 600px) {
            .form-row-3 {
                grid-template-columns: 1fr;
            }
            .rating-scale {
                flex-wrap: wrap;
            }
            .rating-scale label {
                min-width: 60px;
            }
        }
    </style>
</head>
<body>
    <h1>Gravel God Coaching Intake</h1>
    <p class="intro">This comprehensive intake helps us create a personalized training plan matched to your goals, ability, and lifestyle constraints. Takes approximately 20-25 minutes.</p>
    
    <!-- Progress Bar -->
    <div class="progress-container" style="margin-bottom: 24px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <span style="font-size: 13px; font-weight: 600;">PROGRESS</span>
            <span id="progressPercent" style="font-size: 13px; font-weight: 600;">0%</span>
        </div>
        <div style="height: 8px; background: #e0e0e0; border: 1px solid #000;">
            <div id="progressBar" style="height: 100%; width: 0%; background: #000; transition: width 0.3s;"></div>
        </div>
    </div>

    <!-- Section Navigation -->
    <nav class="section-nav" style="margin-bottom: 32px; padding: 12px; background: #f5f5f5; border: 1px solid #000; font-size: 12px; line-height: 2;">
        <a href="#section-1" style="color: #000;">Contact</a> ‚Üí 
        <a href="#section-2" style="color: #000;">Racing</a> ‚Üí 
        <a href="#section-3" style="color: #000;">Fitness</a> ‚Üí 
        <a href="#section-4" style="color: #000;">Strengths</a> ‚Üí 
        <a href="#section-5" style="color: #000;">Availability</a> ‚Üí 
        <a href="#section-6" style="color: #000;">Equipment</a> ‚Üí 
        <a href="#section-7" style="color: #000;">Strength</a> ‚Üí 
        <a href="#section-8" style="color: #000;">Work</a> ‚Üí 
        <a href="#section-9" style="color: #000;">Health</a> ‚Üí 
        <a href="#section-10" style="color: #000;">Social</a> ‚Üí 
        <a href="#section-11" style="color: #000;">Lifestyle</a> ‚Üí 
        <a href="#section-12" style="color: #000;">Context</a> ‚Üí 
        <a href="#section-coaching" style="color: #000; font-weight: 600;">Package ‚úì</a>
    </nav>
    
    <form id="intakeForm" class="survey-form">
        <!-- Honeypot field for bot detection -->
        <input type="text" name="website" class="honeypot" tabindex="-1" autocomplete="off">

        <!-- SECTION 1: CONTACT & DEMOGRAPHICS -->
        <div class="question-group" id="section-1">
            <h2 style="font-size: 18px; font-weight: 600; margin-bottom: 1.5rem; padding-bottom: 8px; border-bottom: 2px solid var(--gg-border); text-transform: uppercase; letter-spacing: 0.1em;">1. Contact & Demographics</h2>
                <div class="question-group">
                    <label class="question-label" for="name">
                        Full Name <span class="required">*</span>
                    </label>
                    <input type="text" id="name" name="name" required>
                </div>
                
                <div class="question-group">
                    <label class="question-label" for="email">
                        Email Address <span class="required">*</span>
                    </label>
                    <input type="email" id="email" name="email" required>
                </div>
                
                <div class="question-group">
                    <label class="question-label" for="phone">Phone Number</label>
                    <input type="text" id="phone" name="phone" placeholder="(555) 123-4567">
                </div>
                
                <div class="question-group">
                    <label class="question-label" for="birthday">Birthday <span class="required">*</span></label>
                    <input type="date" id="birthday" name="birthday" required>
                </div>

                <div class="form-row-3">
                    <div class="question-group">
                        <label class="question-label" for="height_ft">Height <span class="required">*</span>
                            <span class="label-hint">Used for nutrition calculations</span>
                        </label>
                        <div style="display: flex; gap: 8px;">
                            <input type="number" id="height_ft" name="height_ft" placeholder="ft" min="4" max="7" style="width: 70px;">
                            <input type="number" id="height_in" name="height_in" placeholder="in" min="0" max="11" style="width: 70px;">
                            <span style="color: var(--gg-muted); align-self: center; font-size: 12px;">or</span>
                            <input type="number" id="height_cm" name="height_cm" placeholder="cm" min="120" max="220">
                        </div>
                    </div>
                    <div class="question-group">
                        <label class="question-label" for="weight_lbs">Weight <span class="required">*</span>
                            <span class="label-hint">Current weight</span>
                        </label>
                        <div style="display: flex; gap: 8px;">
                            <input type="number" id="weight_lbs" name="weight_lbs" placeholder="lbs" min="80" max="400">
                            <span style="color: var(--gg-muted); align-self: center; font-size: 12px;">or</span>
                            <input type="number" id="weight_kg" name="weight_kg" placeholder="kg" min="35" max="180">
                        </div>
                    </div>
                    <div class="question-group">
                        <label class="question-label" for="sex">Biological Sex <span class="required">*</span>
                            <span class="label-hint">For physiology calculations</span>
                        </label>
                        <select id="sex" name="sex" required>
                            <option value="">Select...</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                        </select>
                    </div>
                </div>
        </div>

        <!-- SECTION 2: RACING GOALS -->
        <div class="question-group" id="section-2">
            <h2 style="font-size: 18px; font-weight: 600; margin-bottom: 1.5rem; padding-bottom: 8px; border-bottom: 2px solid var(--gg-border); text-transform: uppercase; letter-spacing: 0.1em;">2. Racing Goals</h2>
            
            <div class="question-group">
                <label class="question-label" for="has_race_goal">
                    Do you have a specific race goal? <span class="required">*</span>
                </label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="has_race_goal_yes" name="has_race_goal" value="yes" required>
                        <label for="has_race_goal_yes">Yes, I'm targeting specific race(s)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="has_race_goal_no" name="has_race_goal" value="no">
                        <label for="has_race_goal_no">No, general fitness / base building</label>
                    </div>
                </div>
            </div>

            <div class="conditional" id="raceGoalFields">
                <!-- A EVENTS: Primary Races -->
                <div class="question-group" style="margin-bottom: 2rem;">
                    <label class="question-label" style="font-size: 16px; color: #000;">
                        üÖ∞Ô∏è A Events (Primary Races) <span class="required">*</span>
                        <span class="label-hint">Your main target events. The plan is built around these. (Max 3)</span>
                    </label>
                    <div id="a-events-container">
                        <!-- A Event 1 (Required) -->
                        <div class="race-entry" id="a-event-1" style="border: 2px solid #000; padding: 16px; margin-bottom: 12px; background: #f5f5f5;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                <strong style="font-size: 14px;">A Event #1 (Primary)</strong>
                            </div>
                            <div class="form-row" style="margin-bottom: 12px;">
                                <div>
                                    <label style="font-size: 12px; font-weight: 500;">Race Name <span class="required">*</span></label>
                                    <input type="text" name="a_event_1_name" placeholder="e.g., Unbound 200" required>
                                </div>
                                <div>
                                    <label style="font-size: 12px; font-weight: 500;">Date <span class="required">*</span></label>
                                    <input type="date" name="a_event_1_date" id="a_event_1_date" required>
                                </div>
                            </div>
                            <!-- Race Date Warning -->
                            <div id="race-date-warning" style="display: none; margin-bottom: 12px; padding: 10px; font-size: 13px; border: 2px solid #000;"></div>
                            <div class="form-row">
                                <div>
                                    <label style="font-size: 12px; font-weight: 500;">Distance</label>
                                    <div style="display: flex; gap: 8px;">
                                        <input type="number" name="a_event_1_distance" placeholder="200" min="1">
                                        <select name="a_event_1_distance_unit" style="width: 80px;">
                                            <option value="miles">mi</option>
                                            <option value="km">km</option>
                                        </select>
                                    </div>
                                </div>
                                <div>
                                    <label style="font-size: 12px; font-weight: 500;">Goal</label>
                                    <input type="text" name="a_event_1_goal" placeholder="e.g., Sub-12 hours, top 25%">
                                </div>
                            </div>
                        </div>
                        <!-- Additional A Events added dynamically -->
                    </div>
                    <button type="button" onclick="addRaceEvent('a', 3)" class="add-race-btn" id="add-a-event-btn" style="margin-top: 8px; padding: 8px 16px; border: 2px solid #000; background: #fff; cursor: pointer; font-family: inherit; font-size: 13px;">
                        + Add Another A Event
                    </button>
                </div>

                <!-- Why this race matters -->
                <div class="question-group">
                    <label class="question-label" for="race_why">
                        Why do these races matter to you?
                        <span class="label-hint">The deeper motivation helps when training gets hard</span>
                    </label>
                    <textarea id="race_why" name="race_why" rows="3" placeholder="What's driving you toward these goals?"></textarea>
                </div>

                <!-- B EVENTS: Secondary Races -->
                <div class="question-group" style="margin-bottom: 2rem; margin-top: 2rem;">
                    <label class="question-label" style="font-size: 16px; color: #000;">
                        üÖ±Ô∏è B Events (Secondary Races)
                        <span class="label-hint">Important but flexible with training. We'll aim for good performance. (Max 10)</span>
                    </label>
                    <div id="b-events-container">
                        <!-- B events added dynamically -->
                    </div>
                    <button type="button" onclick="addRaceEvent('b', 10)" class="add-race-btn" id="add-b-event-btn" style="margin-top: 8px; padding: 8px 16px; border: 2px solid #000; background: #fff; cursor: pointer; font-family: inherit; font-size: 13px;">
                        + Add B Event
                    </button>
                </div>

                <!-- C EVENTS: Fun/Training Races -->
                <div class="question-group" style="margin-bottom: 2rem;">
                    <label class="question-label" style="font-size: 16px; color: #000;">
                        ‚í∏ C Events (Fun/Training Races)
                        <span class="label-hint">Low priority - training through these or using as tune-ups. (Optional)</span>
                    </label>
                    <div id="c-events-container">
                        <!-- C events added dynamically -->
                    </div>
                    <button type="button" onclick="addRaceEvent('c', 99)" class="add-race-btn" id="add-c-event-btn" style="margin-top: 8px; padding: 8px 16px; border: 2px solid #000; background: #fff; cursor: pointer; font-family: inherit; font-size: 13px;">
                        + Add C Event
                    </button>
                </div>

                <!-- Success Definition -->
                <div class="question-group">
                    <label class="question-label" for="success_definition">
                        What does success look like for your primary A event? <span class="required">*</span>
                        <span class="label-hint">Be specific: finish time, placement, just finishing, etc.</span>
                    </label>
                    <textarea id="success_definition" name="success_definition" rows="3" placeholder="e.g., Finish sub-12 hours, top 25% of age group, just survive and finish, etc."></textarea>
                </div>
            </div>

            <div class="conditional" id="generalFitnessFields">
                <div class="question-group">
                    <label class="question-label" for="general_goal">
                        What are you looking to accomplish? <span class="required">*</span>
                    </label>
                    <textarea id="general_goal" name="general_goal" rows="3" placeholder="Describe your fitness objectives"></textarea>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label" for="training_goals">
                    Training Goals
                    <span class="label-hint">Non-race goals like FTP targets, Strava PRs, etc.</span>
                </label>
                <textarea id="training_goals" name="training_goals" rows="3" placeholder="e.g., Increase FTP to 280W, PR my local KOM, improve climbing"></textarea>
            </div>
        </div>

        <!-- SECTION 3: CURRENT FITNESS -->
        <div class="question-group" id="section-3">
            <h2 style="font-size: 18px; font-weight: 600; margin-bottom: 1.5rem; padding-bottom: 8px; border-bottom: 2px solid var(--gg-border); text-transform: uppercase; letter-spacing: 0.1em;">3. Current Fitness</h2>
            
            <div class="info-box">
                <p><strong>Note:</strong> Don't worry if you don't know some of these numbers. Leave blank if unknown‚Äîwe can test or estimate during training.</p>
            </div>

            <div class="form-row-3">
                <div class="question-group">
                    <label class="question-label" for="ftp">
                        Current FTP (watts)
                        <span class="label-hint">Most recent test result</span>
                    </label>
                    <input type="number" id="ftp" name="ftp" placeholder="e.g., 250" min="50" max="500">
                </div>
                <div class="question-group">
                    <label class="question-label" for="max_hr">
                        Max Heart Rate
                        <span class="label-hint">Highest you've seen recently</span>
                    </label>
                    <input type="number" id="max_hr" name="max_hr" placeholder="e.g., 185" min="100" max="220">
                </div>
                <div class="question-group">
                    <label class="question-label" for="resting_hr">
                        Resting Heart Rate
                        <span class="label-hint">Morning, before getting up</span>
                    </label>
                    <input type="number" id="resting_hr" name="resting_hr" placeholder="e.g., 52" min="30" max="100">
                </div>
            </div>

            <!-- W/kg Calculator Display -->
            <div id="wkg-display" style="display: none; margin-bottom: 1.5rem; padding: 12px 16px; background: #f0f8ff; border: 2px solid #000;">
                <span style="font-size: 13px; font-weight: 600;">YOUR W/kg:</span>
                <span id="wkg-value" style="font-size: 20px; font-weight: 700; margin-left: 12px;">--</span>
                <span id="wkg-category" style="font-size: 13px; margin-left: 12px; color: #666;"></span>
            </div>

            <div class="form-row">
                <div class="question-group">
                    <label class="question-label" for="years_cycling">Total Years Cycling <span class="required">*</span></label>
                    <select id="years_cycling" name="years_cycling" required>
                        <option value="">Select...</option>
                        <option value="0-1">Less than 1 year</option>
                        <option value="1-2">1-2 years</option>
                        <option value="3-5">3-5 years</option>
                        <option value="6-10">6-10 years</option>
                        <option value="10+">10+ years</option>
                    </select>
                </div>
                <div class="question-group">
                    <label class="question-label" for="years_structured">
                        Years of Structured Training <span class="required">*</span>
                        <span class="label-hint">Following a plan, using zones/power</span>
                    </label>
                    <select id="years_structured" name="years_structured" required>
                        <option value="">Select...</option>
                        <option value="0">None / Just riding</option>
                        <option value="0-1">Less than 1 year</option>
                        <option value="1-2">1-2 years</option>
                        <option value="3-5">3-5 years</option>
                        <option value="5+">5+ years</option>
                    </select>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label" for="ability_rating">
                    Rate Your Current Cycling Ability <span class="required">*</span>
                </label>
                <div class="rating-scale">
                    <input type="radio" id="ability1" name="ability_rating" value="1" required>
                    <label for="ability1">1</label>
                    <input type="radio" id="ability2" name="ability_rating" value="2">
                    <label for="ability2">2</label>
                    <input type="radio" id="ability3" name="ability_rating" value="3">
                    <label for="ability3">3</label>
                    <input type="radio" id="ability4" name="ability_rating" value="4">
                    <label for="ability4">4</label>
                    <input type="radio" id="ability5" name="ability_rating" value="5">
                    <label for="ability5">5</label>
                </div>
                <div class="question-help" style="display: flex; justify-content: space-between; padding: 0 4px;">
                    <span>Beginner</span>
                    <span>Intermediate</span>
                    <span>Advanced</span>
                </div>
            </div>

            <div class="form-row">
                <div class="question-group">
                    <label class="question-label" for="races_last_year">Races Completed Last Year</label>
                    <select id="races_last_year" name="races_last_year">
                        <option value="">Select...</option>
                        <option value="0">None</option>
                        <option value="1-2">1-2</option>
                        <option value="3-5">3-5</option>
                        <option value="6-10">6-10</option>
                        <option value="10+">10+</option>
                    </select>
                </div>
                <div class="question-group">
                    <label class="question-label" for="current_hours">
                        Current Weekly Training Hours
                        <span class="label-hint">Average over past month</span>
                    </label>
                    <select id="current_hours" name="current_hours">
                        <option value="">Select...</option>
                        <option value="0-3">0-3 hours</option>
                        <option value="4-6">4-6 hours</option>
                        <option value="7-10">7-10 hours</option>
                        <option value="11-14">11-14 hours</option>
                        <option value="15-18">15-18 hours</option>
                        <option value="18+">18+ hours</option>
                    </select>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label" for="training_history">
                    Summarize Your Training History
                    <span class="label-hint">Background in cycling and other endurance sports</span>
                </label>
                <textarea id="training_history" name="training_history" rows="3" placeholder="e.g., Former runner, started cycling 3 years ago. Did some Zwift racing. Completed 2 gravel races last year."></textarea>
            </div>
        </div>

        <!-- SECTION 6: EQUIPMENT & ENVIRONMENT -->
        <div class="question-group" id="section-6">
            <h2 style="font-size: 18px; font-weight: 600; margin-bottom: 1.5rem; padding-bottom: 8px; border-bottom: 2px solid var(--gg-border); text-transform: uppercase; letter-spacing: 0.1em;">6. Equipment & Environment</h2>
            
            <div class="question-group">
                <label class="question-label" for="indoor_setup">Indoor Training Setup <span class="required">*</span></label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="indoor_smart" name="indoor_setup" value="smart-trainer" required>
                        <label for="indoor_smart">Smart trainer (Wahoo, Tacx, etc. - ERG mode)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="indoor_dumb_pm" name="indoor_setup" value="dumb-trainer-power">
                        <label for="indoor_dumb_pm">Basic trainer + power meter on bike</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="indoor_dumb_no_pm" name="indoor_setup" value="dumb-trainer-no-power">
                        <label for="indoor_dumb_no_pm">Basic trainer, no power meter</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="indoor_rollers" name="indoor_setup" value="rollers">
                        <label for="indoor_rollers">Rollers</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="indoor_none" name="indoor_setup" value="none">
                        <label for="indoor_none">No indoor setup / Outdoor only</label>
                    </div>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label" for="power_meter">Power Meter <span class="required">*</span></label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="pm_bike" name="power_meter" value="yes-bike" required>
                        <label for="pm_bike">Yes, on my bike (pedals, crank, hub)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="pm_trainer" name="power_meter" value="yes-trainer">
                        <label for="pm_trainer">Yes, but only on smart trainer</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="pm_no" name="power_meter" value="no">
                        <label for="pm_no">No power meter</label>
                    </div>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label">Devices & Platforms (select all you use)</label>
                <div class="checkbox-grid">
                    <label class="checkbox-item">
                        <input type="checkbox" name="devices" value="garmin">
                        <span>Garmin</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="devices" value="wahoo">
                        <span>Wahoo</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="devices" value="hrm">
                        <span>Heart Rate Monitor</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="devices" value="strava">
                        <span>Strava</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="devices" value="trainingpeaks">
                        <span>TrainingPeaks</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="devices" value="zwift">
                        <span>Zwift</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="devices" value="trainerroad">
                        <span>TrainerRoad</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="devices" value="whoop">
                        <span>Whoop</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="devices" value="oura">
                        <span>Oura Ring</span>
                    </label>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label">Strength Training Equipment Access</label>
                <div class="checkbox-grid">
                    <label class="checkbox-item">
                        <input type="checkbox" name="strength_equipment" value="gym">
                        <span>Gym membership</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="strength_equipment" value="home-gym">
                        <span>Home gym (weights)</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="strength_equipment" value="dumbbells">
                        <span>Dumbbells/Kettlebells</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="strength_equipment" value="pull-up-bar">
                        <span>Pull-up bar</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="strength_equipment" value="bands">
                        <span>Resistance bands</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="strength_equipment" value="none">
                        <span>None / Bodyweight only</span>
                    </label>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label" for="training_log">Do You Keep a Training Log?</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="log_digital" name="training_log" value="yes-digital">
                        <label for="log_digital">Yes, digital (Strava, TP, etc.)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="log_manual" name="training_log" value="yes-manual">
                        <label for="log_manual">Yes, manual/paper</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="log_no" name="training_log" value="no">
                        <label for="log_no">No</label>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION 7: STRENGTH & MOBILITY -->
        <div class="question-group" id="section-7">
            <h2 style="font-size: 18px; font-weight: 600; margin-bottom: 1.5rem; padding-bottom: 8px; border-bottom: 2px solid var(--gg-border); text-transform: uppercase; letter-spacing: 0.1em;">7. Strength & Mobility</h2>
            
            <div class="question-group">
                <label class="question-label" for="strength_trains">Do You Currently Strength Train?</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="strength_regular" name="strength_trains" value="yes-regular">
                        <label for="strength_regular">Yes, regularly (2+ times/week)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="strength_occasional" name="strength_trains" value="yes-occasional">
                        <label for="strength_occasional">Yes, occasionally</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="strength_no" name="strength_trains" value="no">
                        <label for="strength_no">No</label>
                    </div>
                </div>
                <div class="conditional" id="strengthDetails">
                    <textarea name="strength_routine" placeholder="Describe your current routine (exercises, frequency, duration)"></textarea>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label" for="strength_interest">Interest in Strength Training as Part of Plan</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="strength_eager" name="strength_interest" value="eager">
                        <label for="strength_eager">Eager to include it</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="strength_willing" name="strength_interest" value="willing">
                        <label for="strength_willing">Willing if necessary</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="strength_not" name="strength_interest" value="not-interested">
                        <label for="strength_not">Not interested</label>
                    </div>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label" for="mobility_rating">Rate Your Overall Mobility <span class="required">*</span></label>
                <div class="rating-scale">
                    <input type="radio" id="mobility1" name="mobility_rating" value="1" required>
                    <label for="mobility1">1</label>
                    <input type="radio" id="mobility2" name="mobility_rating" value="2">
                    <label for="mobility2">2</label>
                    <input type="radio" id="mobility3" name="mobility_rating" value="3">
                    <label for="mobility3">3</label>
                    <input type="radio" id="mobility4" name="mobility_rating" value="4">
                    <label for="mobility4">4</label>
                    <input type="radio" id="mobility5" name="mobility_rating" value="5">
                    <label for="mobility5">5</label>
                </div>
                <div class="question-help" style="display: flex; justify-content: space-between; padding: 0 4px;">
                    <span>Very limited</span>
                    <span>Average</span>
                    <span>Excellent</span>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label">Movement Limitations (select all that apply)</label>
                <div class="checkbox-grid">
                    <label class="checkbox-item">
                        <input type="checkbox" name="movement_limits" value="deep-squat">
                        <span>Deep squat painful</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="movement_limits" value="single-leg-balance">
                        <span>Single-leg balance difficult</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="movement_limits" value="pushups-shoulders">
                        <span>Push-ups hurt shoulders</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="movement_limits" value="hip-mobility">
                        <span>Hip mobility issues</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="movement_limits" value="lower-back">
                        <span>Lower back sensitivity</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="movement_limits" value="none">
                        <span>None of these</span>
                    </label>
                </div>
            </div>
        </div>

        <!-- SECTION 5: WEEKLY AVAILABILITY -->
        <div class="question-group" id="section-5">
            <h2 style="font-size: 18px; font-weight: 600; margin-bottom: 1.5rem; padding-bottom: 8px; border-bottom: 2px solid var(--gg-border); text-transform: uppercase; letter-spacing: 0.1em;">5. Weekly Availability</h2>
            
            <div class="info-box">
                <p><strong>Be realistic.</strong> Count the time you'll actually ride, not what you wish you had. Life interferes‚Äîplan for 80% completion.</p>
            </div>

            <div class="question-group">
                <label class="question-label">Weekly Schedule Grid <span class="required">*</span></label>
                <div class="schedule-grid">
                    <table>
                        <thead>
                            <tr>
                                <th>Day</th>
                                <th>Can Train?</th>
                                <th>Best Window</th>
                                <th>Max Duration</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="day-cell">Monday</td>
                                <td>
                                    <select name="mon_available">
                                        <option value="yes">Yes</option>
                                        <option value="maybe">Maybe</option>
                                        <option value="no">No</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="mon_window">
                                        <option value="">--</option>
                                        <option value="early-am">Early AM (5-7a)</option>
                                        <option value="morning">Morning (7-10a)</option>
                                        <option value="midday">Midday (10a-2p)</option>
                                        <option value="afternoon">Afternoon (2-5p)</option>
                                        <option value="evening">Evening (5-8p)</option>
                                        <option value="flexible">Flexible</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="mon_duration">
                                        <option value="">--</option>
                                        <option value="30-60">30-60 min</option>
                                        <option value="60-90">60-90 min</option>
                                        <option value="90-120">90-120 min</option>
                                        <option value="2-3hr">2-3 hours</option>
                                        <option value="3-4hr">3-4 hours</option>
                                        <option value="4+hr">4+ hours</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td class="day-cell">Tuesday</td>
                                <td>
                                    <select name="tue_available">
                                        <option value="yes">Yes</option>
                                        <option value="maybe">Maybe</option>
                                        <option value="no">No</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="tue_window">
                                        <option value="">--</option>
                                        <option value="early-am">Early AM (5-7a)</option>
                                        <option value="morning">Morning (7-10a)</option>
                                        <option value="midday">Midday (10a-2p)</option>
                                        <option value="afternoon">Afternoon (2-5p)</option>
                                        <option value="evening">Evening (5-8p)</option>
                                        <option value="flexible">Flexible</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="tue_duration">
                                        <option value="">--</option>
                                        <option value="30-60">30-60 min</option>
                                        <option value="60-90">60-90 min</option>
                                        <option value="90-120">90-120 min</option>
                                        <option value="2-3hr">2-3 hours</option>
                                        <option value="3-4hr">3-4 hours</option>
                                        <option value="4+hr">4+ hours</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td class="day-cell">Wednesday</td>
                                <td>
                                    <select name="wed_available">
                                        <option value="yes">Yes</option>
                                        <option value="maybe">Maybe</option>
                                        <option value="no">No</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="wed_window">
                                        <option value="">--</option>
                                        <option value="early-am">Early AM (5-7a)</option>
                                        <option value="morning">Morning (7-10a)</option>
                                        <option value="midday">Midday (10a-2p)</option>
                                        <option value="afternoon">Afternoon (2-5p)</option>
                                        <option value="evening">Evening (5-8p)</option>
                                        <option value="flexible">Flexible</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="wed_duration">
                                        <option value="">--</option>
                                        <option value="30-60">30-60 min</option>
                                        <option value="60-90">60-90 min</option>
                                        <option value="90-120">90-120 min</option>
                                        <option value="2-3hr">2-3 hours</option>
                                        <option value="3-4hr">3-4 hours</option>
                                        <option value="4+hr">4+ hours</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td class="day-cell">Thursday</td>
                                <td>
                                    <select name="thu_available">
                                        <option value="yes">Yes</option>
                                        <option value="maybe">Maybe</option>
                                        <option value="no">No</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="thu_window">
                                        <option value="">--</option>
                                        <option value="early-am">Early AM (5-7a)</option>
                                        <option value="morning">Morning (7-10a)</option>
                                        <option value="midday">Midday (10a-2p)</option>
                                        <option value="afternoon">Afternoon (2-5p)</option>
                                        <option value="evening">Evening (5-8p)</option>
                                        <option value="flexible">Flexible</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="thu_duration">
                                        <option value="">--</option>
                                        <option value="30-60">30-60 min</option>
                                        <option value="60-90">60-90 min</option>
                                        <option value="90-120">90-120 min</option>
                                        <option value="2-3hr">2-3 hours</option>
                                        <option value="3-4hr">3-4 hours</option>
                                        <option value="4+hr">4+ hours</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td class="day-cell">Friday</td>
                                <td>
                                    <select name="fri_available">
                                        <option value="yes">Yes</option>
                                        <option value="maybe">Maybe</option>
                                        <option value="no">No</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="fri_window">
                                        <option value="">--</option>
                                        <option value="early-am">Early AM (5-7a)</option>
                                        <option value="morning">Morning (7-10a)</option>
                                        <option value="midday">Midday (10a-2p)</option>
                                        <option value="afternoon">Afternoon (2-5p)</option>
                                        <option value="evening">Evening (5-8p)</option>
                                        <option value="flexible">Flexible</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="fri_duration">
                                        <option value="">--</option>
                                        <option value="30-60">30-60 min</option>
                                        <option value="60-90">60-90 min</option>
                                        <option value="90-120">90-120 min</option>
                                        <option value="2-3hr">2-3 hours</option>
                                        <option value="3-4hr">3-4 hours</option>
                                        <option value="4+hr">4+ hours</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td class="day-cell">Saturday</td>
                                <td>
                                    <select name="sat_available">
                                        <option value="yes">Yes</option>
                                        <option value="maybe">Maybe</option>
                                        <option value="no">No</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="sat_window">
                                        <option value="">--</option>
                                        <option value="early-am">Early AM (5-7a)</option>
                                        <option value="morning">Morning (7-10a)</option>
                                        <option value="midday">Midday (10a-2p)</option>
                                        <option value="afternoon">Afternoon (2-5p)</option>
                                        <option value="evening">Evening (5-8p)</option>
                                        <option value="flexible">Flexible</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="sat_duration">
                                        <option value="">--</option>
                                        <option value="30-60">30-60 min</option>
                                        <option value="60-90">60-90 min</option>
                                        <option value="90-120">90-120 min</option>
                                        <option value="2-3hr">2-3 hours</option>
                                        <option value="3-4hr">3-4 hours</option>
                                        <option value="4+hr">4+ hours</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td class="day-cell">Sunday</td>
                                <td>
                                    <select name="sun_available">
                                        <option value="yes">Yes</option>
                                        <option value="maybe">Maybe</option>
                                        <option value="no">No</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="sun_window">
                                        <option value="">--</option>
                                        <option value="early-am">Early AM (5-7a)</option>
                                        <option value="morning">Morning (7-10a)</option>
                                        <option value="midday">Midday (10a-2p)</option>
                                        <option value="afternoon">Afternoon (2-5p)</option>
                                        <option value="evening">Evening (5-8p)</option>
                                        <option value="flexible">Flexible</option>
                                    </select>
                                </td>
                                <td>
                                    <select name="sun_duration">
                                        <option value="">--</option>
                                        <option value="30-60">30-60 min</option>
                                        <option value="60-90">60-90 min</option>
                                        <option value="90-120">90-120 min</option>
                                        <option value="2-3hr">2-3 hours</option>
                                        <option value="3-4hr">3-4 hours</option>
                                        <option value="4+hr">4+ hours</option>
                                    </select>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label" for="fresh_days">
                    Which Days Do You Usually Feel Freshest? <span class="required">*</span>
                    <span class="label-hint">Best days for hard workouts (select all that apply)</span>
                </label>
                <div class="checkbox-grid">
                    <label class="checkbox-item">
                        <input type="checkbox" name="fresh_days" value="monday">
                        <span>Monday</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="fresh_days" value="tuesday">
                        <span>Tuesday</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="fresh_days" value="wednesday">
                        <span>Wednesday</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="fresh_days" value="thursday">
                        <span>Thursday</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="fresh_days" value="friday">
                        <span>Friday</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="fresh_days" value="saturday">
                        <span>Saturday</span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="fresh_days" value="sunday">
                        <span>Sunday</span>
                    </label>
                </div>
            </div>

            <div class="form-row">
                <div class="question-group">
                    <label class="question-label" for="long_ride_day">Preferred Long Ride Day <span class="required">*</span></label>
                    <select id="long_ride_day" name="long_ride_day" required>
                        <option value="">Select...</option>
                        <option value="saturday">Saturday</option>
                        <option value="sunday">Sunday</option>
                        <option value="either-weekend">Either weekend day</option>
                        <option value="weekday">A weekday (specify in notes)</option>
                    </select>
                </div>
                <div class="question-group">
                    <label class="question-label" for="rest_day">Preferred Rest Day(s)</label>
                    <select id="rest_day" name="rest_day">
                        <option value="">Select...</option>
                        <option value="monday">Monday</option>
                        <option value="tuesday">Tuesday</option>
                        <option value="wednesday">Wednesday</option>
                        <option value="thursday">Thursday</option>
                        <option value="friday">Friday</option>
                        <option value="flexible">Flexible / No preference</option>
                    </select>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label" for="weather_limits">Does Weather Limit Your Training?</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="weather_yes" name="weather_limits" value="yes">
                        <label for="weather_yes">Yes</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="weather_no" name="weather_limits" value="no">
                        <label for="weather_no">No</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="weather_seasonal" name="weather_limits" value="seasonal">
                        <label for="weather_seasonal">Seasonally</label>
                    </div>
                </div>
                <div class="conditional" id="weatherDetails">
                    <textarea name="weather_details" placeholder="Describe how weather affects your training (e.g., can't ride outside Nov-Mar, indoor only when raining)"></textarea>
                </div>
            </div>
        </div>

        <!-- SECTION 11: LIFESTYLE & RECOVERY -->
        <div class="question-group" id="section-11">
            <h2 style="font-size: 18px; font-weight: 600; margin-bottom: 1.5rem; padding-bottom: 8px; border-bottom: 2px solid var(--gg-border); text-transform: uppercase; letter-spacing: 0.1em;">11. Lifestyle & Recovery</h2>
            
            <div class="info-box">
                <p>These factors significantly impact your training adaptation. Be honest‚Äîwe're not here to judge, just to give accurate recommendations.</p>
            </div>

            <div class="question-group">
                <label class="question-label">
                    Alcohol Consumption
                    <span class="label-hint">Average drinks per week (beer, wine, spirits)</span>
                </label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="alcohol_0" name="alcohol_drinks_per_week" value="0">
                        <label for="alcohol_0">None</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="alcohol_1_3" name="alcohol_drinks_per_week" value="2">
                        <label for="alcohol_1_3">1-3 drinks</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="alcohol_4_7" name="alcohol_drinks_per_week" value="5">
                        <label for="alcohol_4_7">4-7 drinks</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="alcohol_8_14" name="alcohol_drinks_per_week" value="11">
                        <label for="alcohol_8_14">8-14 drinks</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="alcohol_15" name="alcohol_drinks_per_week" value="18">
                        <label for="alcohol_15">15+ drinks</label>
                    </div>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label">
                    Daily Caffeine Intake
                    <span class="label-hint">Coffee, energy drinks, pre-workout, etc.</span>
                </label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="caffeine_0" name="caffeine_mg_per_day" value="0">
                        <label for="caffeine_0">None / Decaf only</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="caffeine_100" name="caffeine_mg_per_day" value="100">
                        <label for="caffeine_100">1 cup coffee (~100mg)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="caffeine_200" name="caffeine_mg_per_day" value="200">
                        <label for="caffeine_200">2 cups coffee (~200mg)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="caffeine_300" name="caffeine_mg_per_day" value="300">
                        <label for="caffeine_300">3 cups coffee (~300mg)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="caffeine_400" name="caffeine_mg_per_day" value="400">
                        <label for="caffeine_400">4 cups coffee (~400mg)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="caffeine_500" name="caffeine_mg_per_day" value="500">
                        <label for="caffeine_500">5+ cups coffee (500mg+)</label>
                    </div>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label">
                    Fueling During Rides
                    <span class="label-hint">Do you eat/drink carbs during training rides?</span>
                </label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="fuel_never" name="fuels_during_rides" value="never">
                        <label for="fuel_never">Never ‚Äî I train fasted or just water</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="fuel_rarely" name="fuels_during_rides" value="rarely">
                        <label for="fuel_rarely">Rarely ‚Äî only on very long rides</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="fuel_sometimes" name="fuels_during_rides" value="sometimes">
                        <label for="fuel_sometimes">Sometimes ‚Äî depends on the ride</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="fuel_usually" name="fuels_during_rides" value="usually">
                        <label for="fuel_usually">Usually ‚Äî I fuel most rides >90 min</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="fuel_always" name="fuels_during_rides" value="always">
                        <label for="fuel_always">Always ‚Äî structured fueling every ride</label>
                    </div>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label">
                    Weight Management Goals
                    <span class="label-hint">Be honest‚Äîthis affects how we structure nutrition advice</span>
                </label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="weight_maintain" name="weight_goal" value="maintain">
                        <label for="weight_maintain">Maintain current weight</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="weight_lose_slow" name="weight_goal" value="lose_slow">
                        <label for="weight_lose_slow">Lose weight gradually (sustainable)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="weight_lose_fast" name="weight_goal" value="lose_fast">
                        <label for="weight_lose_fast">Lose weight aggressively</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="weight_gain" name="weight_goal" value="gain">
                        <label for="weight_gain">Gain weight/muscle</label>
                    </div>
                </div>
            </div>

            <div class="question-group">
                <label class="question-label">
                    Have You Ever Struggled With Disordered Eating?
                    <span class="label-hint">Restriction, binging, purging, excessive exercise for weight control. Completely confidential.</span>
                </label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="ed_no" name="eating_disorder_history" value="false">
                        <label for="ed_no">No</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="ed_past" name="eating_disorder_history" value="past">
                        <label for="ed_past">Yes, in the past but recovered</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="ed_current" name="eating_disorder_history" value="current">
                        <label for="ed_current">Yes, currently struggling</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="ed_skip" name="eating_disorder_history" value="prefer_not_say">
                        <label for="ed_skip">Prefer not to say</label>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECTION 12: PERSONAL CONTEXT -->
        <div class="question-group" id="section-12">
            <h2 style="font-size: 18px; font-weight: 600; margin-bottom: 1.5rem; padding-bottom: 8px; border-bottom: 2px solid var(--gg-border); text-transform: uppercase; letter-spacing: 0.1em;">12. Personal Context</h2>
            
            <div class="info-box">
                <p>This section helps us understand you as a person, not just an athlete. It's optional but helps us provide better coaching.</p>
            </div>

            <div class="question-group">
                <label class="question-label" for="important_people">The Most Important People in Your Life Are...</label>
                <textarea id="important_people" name="important_people" rows="2" placeholder="Who matters most to you"></textarea>
            </div>

            <div class="question-group">
                <label class="question-label" for="cycling_meaning">
                    What Does Cycling/Racing Mean to You?
                    <span class="label-hint">Beyond fitness‚Äîwhat role does it play in your life?</span>
                </label>
                <textarea id="cycling_meaning" name="cycling_meaning" rows="3" placeholder="e.g., Stress relief, identity, social connection, competition, adventure"></textarea>
            </div>

            <div class="question-group">
                <label class="question-label" for="anything_else">
                    Anything Else We Should Know?
                    <span class="label-hint">Life circumstances, concerns, context we haven't asked about</span>
                </label>
                <textarea id="anything_else" name="anything_else" rows="3" placeholder="Tell us anything else that might be relevant"></textarea>
            </div>
        </div>
        
        <!-- FINAL SECTION: COACHING PACKAGE -->
        <div class="question-group" id="section-coaching" style="margin-top: 3rem; padding-top: 2rem; border-top: 3px solid #000;">
            <h2 style="font-size: 20px; font-weight: 700; margin-bottom: 1rem; text-transform: uppercase; letter-spacing: 0.12em;">Almost Done ‚Äî Choose Your Package</h2>
            <p style="color: #666; margin-bottom: 1.5rem; font-size: 14px;">Same coach. Same standards. Different involvement. <a href="https://gravelgodcycling.com/coaching/" target="_blank" style="color: #000; text-decoration: underline;">Full details ‚Üí</a></p>
            
            <div class="radio-group" style="gap: 16px;">
                <div class="radio-option" style="padding: 16px; border: 2px solid #000;">
                    <input type="radio" id="tier_min" name="coaching_tier" value="min" required>
                    <label for="tier_min" style="flex: 1;">
                        <strong style="font-size: 16px;">MIN ‚Äî $199/mo</strong><br>
                        <span style="font-size: 13px; color: #666;">
                            Weekly review ‚Ä¢ Light analysis ‚Ä¢ Quarterly calls<br>
                            <em>For experienced athletes who execute without hand-holding</em>
                        </span>
                    </label>
                </div>
                <div class="radio-option" style="padding: 16px; border: 2px solid #000; background: #f0f0f0;">
                    <input type="radio" id="tier_mid" name="coaching_tier" value="mid">
                    <label for="tier_mid" style="flex: 1;">
                        <strong style="font-size: 16px;">MID ‚Äî $299/mo</strong> <span style="background: #000; color: #fff; padding: 2px 6px; font-size: 10px; margin-left: 8px;">POPULAR</span><br>
                        <span style="font-size: 13px; color: #666;">
                            Weekly review ‚Ä¢ Thorough analysis ‚Ä¢ Monthly calls<br>
                            <em>For serious athletes who want clear feedback + weekly adjustments</em>
                        </span>
                    </label>
                </div>
                <div class="radio-option" style="padding: 16px; border: 2px solid #000;">
                    <input type="radio" id="tier_max" name="coaching_tier" value="max">
                    <label for="tier_max" style="flex: 1;">
                        <strong style="font-size: 16px;">MAX ‚Äî $1,200/mo</strong><br>
                        <span style="font-size: 13px; color: #666;">
                            Daily review ‚Ä¢ Extensive support ‚Ä¢ On-demand calls<br>
                            <em>For athletes who want immediate feedback + high-touch support</em>
                        </span>
                    </label>
                </div>
            </div>
        </div>
        
        <div style="display: flex; gap: 16px; justify-content: space-between; align-items: center; padding: 24px; background: var(--gg-soft); border: 1px solid var(--gg-border); border-radius: var(--radius); margin-top: 32px;">
            <div style="display: flex; gap: 12px;">
                <button type="button" class="btn btn-secondary" onclick="saveProgress()" style="padding: 14px 28px; background: var(--gg-bg); color: var(--gg-fg); border: 1px solid var(--gg-border); font-family: inherit; font-size: 13px; font-weight: 600; letter-spacing: 0.08em; text-transform: uppercase; cursor: pointer; transition: all 0.2s;">
                    üíæ Save Progress
                </button>
                <button type="button" class="btn btn-secondary" onclick="loadProgress()" style="padding: 14px 28px; background: var(--gg-bg); color: var(--gg-fg); border: 1px solid var(--gg-border); font-family: inherit; font-size: 13px; font-weight: 600; letter-spacing: 0.08em; text-transform: uppercase; cursor: pointer; transition: all 0.2s;">
                    üìÇ Load Saved
                </button>
            </div>
            <button type="submit" class="submit-button" id="submitBtn">Submit Intake ‚Üí</button>
        </div>
    </form>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" style="position: fixed; inset: 0; background: rgba(10, 10, 10, 0.95); display: none; align-items: center; justify-content: center; flex-direction: column; gap: 24px; z-index: 2000;">
        <div style="width: 48px; height: 48px; border: 3px solid var(--gg-border); border-top-color: var(--gg-fg); border-radius: 50%; animation: spin 1s linear infinite;"></div>
        <div style="font-size: 14px; color: var(--gg-muted);">Processing your intake...</div>
    </div>

    <style>
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .btn-secondary:hover {
            border-color: var(--gg-fg) !important;
        }
    </style>
    
    <script>
        // Race event counters
        let aEventCount = 1;
        let bEventCount = 0;
        let cEventCount = 0;

        // Add race event function
        function addRaceEvent(priority, maxEvents) {
            let container, count, countVar;
            
            if (priority === 'a') {
                container = document.getElementById('a-events-container');
                count = ++aEventCount;
                if (count > maxEvents) {
                    alert('Maximum of 3 A events allowed');
                    aEventCount--;
                    return;
                }
            } else if (priority === 'b') {
                container = document.getElementById('b-events-container');
                count = ++bEventCount;
                if (count > maxEvents) {
                    bEventCount--;
                    return;
                }
            } else {
                container = document.getElementById('c-events-container');
                count = ++cEventCount;
            }
            
            const priorityLabel = priority.toUpperCase();
            const borderColor = priority === 'a' ? '#000' : (priority === 'b' ? '#666' : '#999');
            const bgColor = priority === 'a' ? '#f5f5f5' : (priority === 'b' ? '#fafafa' : '#fff');
            
            const eventHtml = `
                <div class="race-entry" id="${priority}-event-${count}" style="border: 2px solid ${borderColor}; padding: 16px; margin-bottom: 12px; background: ${bgColor};">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <strong style="font-size: 14px;">${priorityLabel} Event #${count}</strong>
                        <button type="button" onclick="removeRaceEvent('${priority}', ${count})" style="padding: 4px 12px; border: 1px solid #999; background: #fff; cursor: pointer; font-size: 12px;">Remove</button>
                    </div>
                    <div class="form-row" style="margin-bottom: 12px;">
                        <div>
                            <label style="font-size: 12px; font-weight: 500;">Race Name</label>
                            <input type="text" name="${priority}_event_${count}_name" placeholder="e.g., SBT GRVL">
                        </div>
                        <div>
                            <label style="font-size: 12px; font-weight: 500;">Date</label>
                            <input type="date" name="${priority}_event_${count}_date">
                        </div>
                    </div>
                    <div class="form-row">
                        <div>
                            <label style="font-size: 12px; font-weight: 500;">Distance</label>
                            <div style="display: flex; gap: 8px;">
                                <input type="number" name="${priority}_event_${count}_distance" placeholder="100" min="1">
                                <select name="${priority}_event_${count}_distance_unit" style="width: 80px;">
                                    <option value="miles">mi</option>
                                    <option value="km">km</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label style="font-size: 12px; font-weight: 500;">Goal/Notes</label>
                            <input type="text" name="${priority}_event_${count}_goal" placeholder="${priority === 'c' ? 'e.g., Training ride, tune-up' : 'e.g., Finish strong'}">
                        </div>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', eventHtml);
            
            // Hide add button if max reached
            if (priority === 'a' && aEventCount >= maxEvents) {
                document.getElementById('add-a-event-btn').style.display = 'none';
            }
        }

        // Remove race event function
        function removeRaceEvent(priority, eventNum) {
            const element = document.getElementById(`${priority}-event-${eventNum}`);
            if (element) {
                element.remove();
                
                // Show add button again
                if (priority === 'a') {
                    aEventCount--;
                    document.getElementById('add-a-event-btn').style.display = 'block';
                } else if (priority === 'b') {
                    bEventCount--;
                } else {
                    cEventCount--;
                }
            }
        }

        // Race Date Validation
        function validateRaceDate() {
            const dateInput = document.getElementById('a_event_1_date');
            const warning = document.getElementById('race-date-warning');
            
            if (!dateInput || !dateInput.value) {
                if (warning) warning.style.display = 'none';
                return;
            }
            
            const raceDate = new Date(dateInput.value);
            const today = new Date();
            const weeksOut = Math.floor((raceDate - today) / (7 * 24 * 60 * 60 * 1000));
            
            let message = '';
            let bgColor = '';
            
            if (weeksOut < 0) {
                message = '‚ö†Ô∏è This date is in the past';
                bgColor = '#ffebee';
            } else if (weeksOut < 8) {
                message = `‚ö†Ô∏è ${weeksOut} weeks out ‚Äî Very short timeline. Plan will be compressed, expectations adjusted.`;
                bgColor = '#fff3e0';
            } else if (weeksOut < 12) {
                message = `‚è±Ô∏è ${weeksOut} weeks out ‚Äî Tight but workable. Some phase compression expected.`;
                bgColor = '#fff8e1';
            } else if (weeksOut < 16) {
                message = `‚úì ${weeksOut} weeks out ‚Äî Good timeline for meaningful preparation.`;
                bgColor = '#e8f5e9';
            } else if (weeksOut < 24) {
                message = `‚úì ${weeksOut} weeks out ‚Äî Solid timeline. Full periodization possible.`;
                bgColor = '#e8f5e9';
            } else if (weeksOut <= 52) {
                message = `‚úì ${weeksOut} weeks out ‚Äî Excellent timeline for comprehensive preparation.`;
                bgColor = '#e8f5e9';
            } else {
                message = `üìÖ ${weeksOut} weeks out ‚Äî That's over a year away. We'll plan in phases.`;
                bgColor = '#e3f2fd';
            }
            
            if (warning) {
                warning.textContent = message;
                warning.style.display = 'block';
                warning.style.background = bgColor;
            }
        }

        // W/kg Calculator
        function updateWkg() {
            const ftpInput = document.getElementById('ftp');
            const weightKgInput = document.getElementById('weight_kg');
            const weightLbsInput = document.getElementById('weight_lbs');
            const wkgDisplay = document.getElementById('wkg-display');
            const wkgValue = document.getElementById('wkg-value');
            const wkgCategory = document.getElementById('wkg-category');
            
            if (!ftpInput || !wkgDisplay || !wkgValue) return;
            
            const ftp = parseFloat(ftpInput.value);
            let weightKg = parseFloat(weightKgInput?.value);
            
            // Convert from lbs if needed
            if (!weightKg && weightLbsInput?.value) {
                weightKg = parseFloat(weightLbsInput.value) * 0.453592;
            }
            
            if (ftp && weightKg && ftp > 0 && weightKg > 0) {
                const wkg = (ftp / weightKg).toFixed(2);
                wkgValue.textContent = wkg;
                wkgDisplay.style.display = 'block';
                
                // Add category
                let category = '';
                if (wkg < 2.5) category = 'Beginner';
                else if (wkg < 3.0) category = 'Recreational';
                else if (wkg < 3.5) category = 'Trained';
                else if (wkg < 4.0) category = 'Competitive';
                else if (wkg < 4.5) category = 'Very Strong';
                else if (wkg < 5.0) category = 'Cat 1/2';
                else if (wkg < 5.5) category = 'Elite Amateur';
                else if (wkg < 6.0) category = 'Domestic Pro';
                else category = 'World Tour';
                
                if (wkgCategory) wkgCategory.textContent = `(${category})`;
            } else {
                wkgDisplay.style.display = 'none';
            }
        }

        // Progress Bar Update
        function updateProgress() {
            const form = document.getElementById('intakeForm');
            const allInputs = form.querySelectorAll('input[required], select[required], textarea[required]');
            let filled = 0;
            
            allInputs.forEach(input => {
                if (input.type === 'radio') {
                    const name = input.name;
                    if (form.querySelector(`input[name="${name}"]:checked`)) {
                        filled++;
                    }
                } else if (input.value.trim()) {
                    filled++;
                }
            });
            
            // Count unique radio groups
            const radioGroups = new Set();
            form.querySelectorAll('input[type="radio"][required]').forEach(r => radioGroups.add(r.name));
            const totalRequired = allInputs.length - form.querySelectorAll('input[type="radio"][required]').length + radioGroups.size;
            
            const percent = Math.round((filled / totalRequired) * 100);
            document.getElementById('progressBar').style.width = percent + '%';
            document.getElementById('progressPercent').textContent = percent + '%';
        }

        // Conditional field logic
        function setupConditionals() {
            // Race goal fields
            document.querySelectorAll('[name="has_race_goal"]').forEach(radio => {
                radio.addEventListener('change', () => {
                    const raceFields = document.getElementById('raceGoalFields');
                    const generalFields = document.getElementById('generalFitnessFields');
                    if (radio.value === 'yes' && radio.checked) {
                        raceFields.classList.add('visible');
                        generalFields.classList.remove('visible');
                    } else if (radio.value === 'no' && radio.checked) {
                        raceFields.classList.remove('visible');
                        generalFields.classList.add('visible');
                    }
                });
            });

            // Weather details
            document.querySelectorAll('[name="weather_limits"]').forEach(radio => {
                radio.addEventListener('change', () => {
                    const show = radio.value !== 'no' && radio.checked;
                    document.getElementById('weatherDetails').classList.toggle('visible', show);
                });
            });

            // Strength training details
            document.querySelectorAll('[name="strength_trains"]').forEach(radio => {
                radio.addEventListener('change', () => {
                    const show = radio.value.startsWith('yes') && radio.checked;
                    document.getElementById('strengthDetails').classList.toggle('visible', show);
                });
            });

            // Previous coach details
            document.querySelectorAll('[name="previous_coach"]').forEach(radio => {
                radio.addEventListener('change', () => {
                    document.getElementById('coachDetails').classList.toggle('visible', radio.value === 'yes' && radio.checked);
                });
            });

            // Bike pain details
            document.querySelectorAll('[name="bike_pain"]').forEach(radio => {
                radio.addEventListener('change', () => {
                    document.getElementById('bikePainDetails').classList.toggle('visible', radio.value === 'yes' && radio.checked);
                });
            });
        }

        // Checkbox item styling
        document.querySelectorAll('.checkbox-item input[type="checkbox"]').forEach(cb => {
            cb.addEventListener('change', () => {
                cb.closest('.checkbox-item').classList.toggle('selected', cb.checked);
            });
        });

        // Local Storage - Save/Load Progress
        function saveProgress() {
            const form = document.getElementById('intakeForm');
            const formData = new FormData(form);
            const data = {};
            
            formData.forEach((value, key) => {
                if (data[key]) {
                    if (Array.isArray(data[key])) {
                        data[key].push(value);
                    } else {
                        data[key] = [data[key], value];
                    }
                } else {
                    data[key] = value;
                }
            });
            
            // Save race event counts for dynamic recreation
            data._raceEventCounts = {
                a: aEventCount,
                b: bEventCount,
                c: cEventCount
            };
            
            localStorage.setItem('ggIntakeFormData', JSON.stringify(data));
            alert('Progress saved! You can close this page and return later.');
        }

        function loadProgress() {
            const saved = localStorage.getItem('ggIntakeFormData');
            if (!saved) {
                alert('No saved progress found.');
                return;
            }
            const data = JSON.parse(saved);
            const form = document.getElementById('intakeForm');
            
            // Recreate dynamic race events first
            if (data._raceEventCounts) {
                const counts = data._raceEventCounts;
                // Add A events (start from 2 since 1 is always present)
                for (let i = 2; i <= counts.a; i++) {
                    addRaceEvent('a', 3);
                }
                // Add B events
                for (let i = 1; i <= counts.b; i++) {
                    addRaceEvent('b', 10);
                }
                // Add C events
                for (let i = 1; i <= counts.c; i++) {
                    addRaceEvent('c', 99);
                }
            }
            
            Object.keys(data).forEach(key => {
                if (key === '_raceEventCounts') return; // Skip metadata
                const fields = form.querySelectorAll(`[name="${key}"]`);
                if (!fields.length) return;
                const value = data[key];
                
                fields.forEach(field => {
                    if (field.type === 'radio') {
                        field.checked = field.value === value;
                    } else if (field.type === 'checkbox') {
                        const values = Array.isArray(value) ? value : [value];
                        field.checked = values.includes(field.value);
                        if (field.checked) {
                            field.closest('.checkbox-item')?.classList.add('selected');
                        }
                    } else {
                        field.value = value;
                    }
                });
            });

            // Trigger conditional visibility
            document.querySelectorAll('input[type="radio"]:checked').forEach(r => {
                r.dispatchEvent(new Event('change'));
            });
            alert('Progress loaded!');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            setupConditionals();
            
            // Race date validation
            const raceDateInput = document.getElementById('a_event_1_date');
            if (raceDateInput) {
                raceDateInput.addEventListener('change', validateRaceDate);
                validateRaceDate(); // Check on load if value exists
            }
            
            // W/kg calculator
            const ftpInput = document.getElementById('ftp');
            const weightKgInput = document.getElementById('weight_kg');
            const weightLbsInput = document.getElementById('weight_lbs');
            
            if (ftpInput) ftpInput.addEventListener('input', updateWkg);
            if (weightKgInput) weightKgInput.addEventListener('input', updateWkg);
            if (weightLbsInput) weightLbsInput.addEventListener('input', updateWkg);
            
            // Progress bar updates
            document.querySelectorAll('input, select, textarea').forEach(el => {
                el.addEventListener('change', updateProgress);
                el.addEventListener('input', updateProgress);
            });
            updateProgress(); // Initial calculation
            
            // Auto-save every 30 seconds if form has changed
            let lastFormState = '';
            setInterval(() => {
                const form = document.getElementById('intakeForm');
                const currentState = new FormData(form).toString();
                if (currentState !== lastFormState && lastFormState !== '') {
                    // Silent auto-save (no alert)
                    const formData = new FormData(form);
                    const data = {};
                    formData.forEach((value, key) => {
                        if (data[key]) {
                            if (Array.isArray(data[key])) {
                                data[key].push(value);
                            } else {
                                data[key] = [data[key], value];
                            }
                        } else {
                            data[key] = value;
                        }
                    });
                    data._raceEventCounts = { a: aEventCount, b: bEventCount, c: cEventCount };
                    localStorage.setItem('ggIntakeFormData', JSON.stringify(data));
                    console.log('Auto-saved at', new Date().toLocaleTimeString());
                }
                lastFormState = currentState;
            }, 30000);
            
            // Check for saved progress
            if (localStorage.getItem('ggIntakeFormData')) {
                if (confirm('We found saved progress. Would you like to load it?')) {
                    loadProgress();
                }
            }
        });

        // Webhook URL - UPDATE THIS after deploying Cloudflare Worker
        const WEBHOOK_URL = 'https://nameless-brook-9c7d.gravelgodcoaching.workers.dev';
        // For local testing, use: 'http://localhost:8787'

        // Form submission
        document.getElementById('intakeForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Honeypot check
            if (document.querySelector('input[name="website"]').value) {
                console.log('Bot detected');
                return;
            }
            
            const submitBtn = document.getElementById('submitBtn');
            const loadingOverlay = document.getElementById('loadingOverlay');
            
            // Show loading
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';
            loadingOverlay.style.display = 'flex';
            
            // Collect form data
            const formData = new FormData(e.target);
            const data = {};
            for (let [key, value] of formData.entries()) {
                if (data[key]) {
                    if (Array.isArray(data[key])) {
                        data[key].push(value);
                    } else {
                        data[key] = [data[key], value];
                    }
                } else {
                    data[key] = value;
                }
            }
            
            // Add race event counts for backend processing
            data._raceEventCounts = {
                a: aEventCount,
                b: bEventCount,
                c: cEventCount
            };
            
            console.log('Submitting form data:', data);
            
            try {
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    // Clear saved progress on successful submit
                    localStorage.removeItem('ggIntakeFormData');
                    
                    // Hide loading and show success
                    loadingOverlay.style.display = 'none';
                    
                    // Show success message
                    showSuccessMessage(result.message || 'Intake received! Check your email within 24 hours.');
                    e.target.reset();
                } else {
                    throw new Error(result.error || 'Submission failed');
                }
            } catch (error) {
                console.error('Submission error:', error);
                loadingOverlay.style.display = 'none';
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit Intake ‚Üí';
                
                alert(`Error: ${error.message}\n\nPlease try again. If the problem persists, email your intake to coach@gravelgodcycling.com`);
            }
        });

        // Success message display
        function showSuccessMessage(message) {
            const form = document.getElementById('intakeForm');
            form.innerHTML = `
                <div style="text-align: center; padding: 60px 20px;">
                    <div style="font-size: 64px; margin-bottom: 24px;">‚úì</div>
                    <h2 style="font-size: 24px; margin-bottom: 16px; text-transform: uppercase; letter-spacing: 0.1em;">Intake Received</h2>
                    <p style="font-size: 16px; color: #666; margin-bottom: 32px; max-width: 500px; margin-left: auto; margin-right: auto;">
                        ${message}
                    </p>
                    <div style="padding: 20px; background: #f5f5f5; border: 1px solid #000; max-width: 400px; margin: 0 auto;">
                        <p style="font-size: 14px; margin: 0;">
                            <strong>What happens next:</strong><br>
                            1. I review your intake (within 24 hours)<br>
                            2. You receive your initial plan + calendar<br>
                            3. We schedule a kickoff call (MID/MAX tiers)
                        </p>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
